var PlayerController=pc.createScript("playerController");PlayerController.attributes.add("movementSpeed",{type:"number",description:"speedOfPlayer",default:2}),PlayerController.attributes.add("stunLength",{type:"number",description:"length of stun",default:2}),PlayerController.attributes.add("wallLeft",{type:"entity"}),PlayerController.attributes.add("wallRight",{type:"entity"}),PlayerController.attributes.add("wallTop",{type:"entity"}),PlayerController.attributes.add("wallBot",{type:"entity"}),PlayerController.prototype.initialize=function(){let t=this;this.originalPosition=this.entity.getPosition().clone(),this.gameStarted=!1,this.isLeftButtonPressed=!1,this.isRightButtonPressed=!1,this.isUpButtonPressed=!1,this.isDownButtonPressed=!1,this.movementCoefficient=0,this.isSwinging=!1,this.lastDirection="down",this.isStunned=!1,this.stunTimer=0,this.app.on("moveStart",(function(i){t.clearMovementButtons(),t.lastDirection=i,"left"===i?t.isLeftButtonPressed=!0:"right"===i?t.isRightButtonPressed=!0:"up"===i?t.isUpButtonPressed=!0:"down"===i&&(t.isDownButtonPressed=!0),t.isSwinging||t.isStunned||!t.gameStarted||t.app.fire("player:playAnimation","walk",t.lastDirection)})),this.app.on("moveStop",(function(i){"left"===i?t.isLeftButtonPressed=!1:"right"===i?t.isRightButtonPressed=!1:"up"===i?t.isUpButtonPressed=!1:"down"===i&&(t.isDownButtonPressed=!1),t.isSwinging||t.isStunned||!t.gameStarted||t.isMoving()||t.app.fire("player:playAnimation","idle",t.lastDirection)})),this.app.on("collisionStart",(function(){t.nudgeOutOfCollision(t.lastDirection),t.clearMovementButtons()})),this.app.on("startGame",(function(){t.gameStarted=!0,t.resumeMovement()}),this),this.app.on("swingStart",(function(){t.gameStarted&&(t.isSwinging||t.isStunned||(t.isSwinging=!0,t.app.fire("player:playAnimation","swing",t.lastDirection)))})),this.app.on("swingEnd",(function(){t.isSwinging=!1,t.resumeMovement()})),this.app.on("playerHitByExplosion",(function(){t.stunStart()})),this.app.on("stopGame",(function(){t.gameStarted=!1,t.clearMovementButtons(),t.isSwinging||t.isStunned||t.app.fire("player:playAnimation","idle","down")})),this.app.on("resetPlayerController",(function(){t.lastDirection="down",t.isSwinging=!1,t.isStunned=!1,t.stunTimer=0,t.app.fire("player:playAnimation","idle","down"),t.clearMovementButtons(),t.entity.setPosition(t.originalPosition)}))},PlayerController.prototype.update=function(t){this.isStunned?(this.stunTimer+=t,this.stunTimer>=this.stunLength&&this.stunEnd()):this.gameStarted&&(this.isLeftButtonPressed||this.isRightButtonPressed||this.isUpButtonPressed||this.isDownButtonPressed?this.movementCoefficient<=1&&(this.movementCoefficient+=12*t):this.movementCoefficient=0,this.isSwinging||(this.isLeftButtonPressed&&this.entity.translate(t*(-this.movementSpeed*this.movementCoefficient),0,0),this.isRightButtonPressed&&this.entity.translate(t*(this.movementSpeed*this.movementCoefficient),0,0),this.isUpButtonPressed&&this.entity.translate(0,t*(this.movementSpeed*this.movementCoefficient),0),this.isDownButtonPressed&&this.entity.translate(0,t*(-this.movementSpeed*this.movementCoefficient),0)),this.entity.getPosition().x<this.wallLeft.getPosition().x?this.wrapScreen(this.wallLeft):this.entity.getPosition().x>this.wallRight.getPosition().x?this.wrapScreen(this.wallRight):this.entity.getPosition().y<this.wallBot.getPosition().y?this.wrapScreen(this.wallBot):this.entity.getPosition().y>this.wallTop.getPosition().y&&this.wrapScreen(this.wallTop))},PlayerController.prototype.stunStart=function(){this.stunTimer=0,this.isSwinging=!1,this.isStunned=!0,this.app.fire("player:playAnimation","stunned",this.lastDirection)},PlayerController.prototype.stunEnd=function(){this.isStunned=!1,this.resumeMovement()},PlayerController.prototype.resumeMovement=function(){this.gameStarted?this.isMoving()?this.app.fire("player:playAnimation","walk",this.lastDirection):this.app.fire("player:playAnimation","idle",this.lastDirection):this.app.fire("player:playAnimation","idle","down")},PlayerController.prototype.nudgeOutOfCollision=function(t){let i=.03;"left"===t?this.entity.translate(this.movementSpeed*this.movementCoefficient*i,0,0):"right"===t?this.entity.translate(-this.movementSpeed*this.movementCoefficient*i,0,0):"up"===t?this.entity.translate(0,-this.movementSpeed*this.movementCoefficient*i,0):"down"===t&&this.entity.translate(0,this.movementSpeed*this.movementCoefficient*i,0)},PlayerController.prototype.wrapScreen=function(t){let i=.05;if(t===this.wallLeft){let t=this.wallRight.getPosition();this.entity.setPosition(t.x-i,t.y,this.entity.getPosition().z)}else if(t===this.wallRight){let t=this.wallLeft.getPosition();this.entity.setPosition(t.x+i,t.y,this.entity.getPosition().z)}else if(t===this.wallTop){let t=this.wallBot.getPosition();this.entity.setPosition(t.x,t.y+i,this.entity.getPosition().z)}else if(t===this.wallBot){let t=this.wallTop.getPosition();this.entity.setPosition(t.x,t.y-i,this.entity.getPosition().z)}},PlayerController.prototype.clearMovementButtons=function(){this.isLeftButtonPressed=!1,this.isRightButtonPressed=!1,this.isUpButtonPressed=!1,this.isDownButtonPressed=!1},PlayerController.prototype.isMoving=function(){return!!(this.isLeftButtonPressed||this.isRightButtonPressed||this.isUpButtonPressed||this.isDownButtonPressed)};var InputManager=pc.createScript("inputManager");InputManager.attributes.add("hammerBtn",{type:"entity"}),InputManager.attributes.add("startBtn",{type:"entity"}),InputManager.attributes.add("resetBtn0",{type:"entity"}),InputManager.attributes.add("resetBtn1",{type:"entity"}),InputManager.attributes.add("claimCpnBtn0",{type:"entity"}),InputManager.attributes.add("claimCpnBtn1",{type:"entity"}),InputManager.attributes.add("dpad",{type:"entity"}),InputManager.attributes.add("dpadDeadZone",{type:"number",description:"increases width of hitbox",default:20}),InputManager.attributes.add("dpadMaxDistance",{type:"number",description:"increases width of hitbox",default:300}),InputManager.prototype.initialize=function(){let t=this;this.hammerBtn.button.on("touchstart",(function(){t.app.fire("swingButtonPress")}),this),this.hammerBtn.button.on("touchleave",(function(){t.app.fire("swingButtonRelease")}),this),this.hammerBtn.button.on("touchend",(function(){t.app.fire("swingButtonRelease")}),this),this.startBtn.button.on("touchend",(function(){t.app.fire("startButtonPress")}),this),this.resetBtn0.button.on("touchend",(function(){t.app.fire("resetButtonPress")}),this),this.resetBtn1.button.on("touchend",(function(){t.app.fire("resetButtonPress")}),this),this.claimCpnBtn0.button.on("touchend",(function(){t.app.fire("couponButtonPress")}),this),this.claimCpnBtn1.button.on("touchend",(function(){t.app.fire("couponButtonPress")}),this),this.touchCoords={x:0,y:0},this.lastDpadDirection=void 0,this.currentDpadDirection=void 0,this.dpadOriginCoords=void 0,this.dpadPressed=!1,this.dpad.button.on("touchstart",(function(e){t.resetDpadCoords(),t.dpadPressed=!0,t.touchCoords.x=e.x,t.touchCoords.y=e.y,this.handleDpadDirectionPress()}),this),this.dpad.element.on("touchmove",(function(e){t.touchCoords.x=e.x,t.touchCoords.y=e.y,t.hasLeftDpad()&&("undefined"!=t.currentDpadDirection&&t.app.fire("movementButtonRelease",this.currentDpadDirection),this.clearDpad(),t.dpadPressed=!1),t.dpadPressed&&t.handleDpadDirectionPress()}),this),this.dpad.element.on("touchend",(function(){"undefined"!=t.currentDpadDirection&&t.app.fire("movementButtonRelease",this.currentDpadDirection),this.clearDpad(),t.dpadPressed=!1}),this),this.dpad.element.on("touchcancel",(function(){"undefined"!=t.currentDpadDirection&&t.app.fire("movementButtonRelease",this.currentDpadDirection),t.clearDpad(),t.dpadPressed=!1}),this)},InputManager.prototype.hasLeftDpad=function(){return this.distance2D(this.touchCoords.x,this.touchCoords.y,this.dpadOriginCoords.x,this.dpadOriginCoords.y)>this.dpadMaxDistance},InputManager.prototype.handleDpadDirectionPress=function(){let t=this.distance2D(this.touchCoords.x,this.touchCoords.y,this.dpadOriginCoords.x,this.dpadOriginCoords.y);if(t>this.dpadDeadZone&&t<this.dpadMaxDistance){let t=this.angleBetweenPts2D(this.touchCoords.x,this.touchCoords.y,this.dpadOriginCoords.x,this.dpadOriginCoords.y);t>=0&&t<45||t>=315&&t<=360?"right"!=this.currentDpadDirection&&("undefined"!=this.lastDpadDirection&&this.app.fire("movementButtonRelease",this.lastDpadDirection),this.lastDpadDirection=this.currentDpadDirection,this.currentDpadDirection="right",this.app.fire("movementButtonPress","right")):t<135&&t>=45?"down"!=this.currentDpadDirection&&("undefined"!=this.lastDpadDirection&&this.app.fire("movementButtonRelease",this.lastDpadDirection),this.lastDpadDirection=this.currentDpadDirection,this.currentDpadDirection="down",this.app.fire("movementButtonPress","down")):t<225&&t>=135?"left"!=this.currentDpadDirection&&("undefined"!=this.lastDpadDirection&&this.app.fire("movementButtonRelease",this.lastDpadDirection),this.lastDpadDirection=this.currentDpadDirection,this.currentDpadDirection="left",this.app.fire("movementButtonPress","left")):t<315&&t>=225&&"up"!=this.currentDpadDirection&&("undefined"!=this.lastDpadDirection&&this.app.fire("movementButtonRelease",this.lastDpadDirection),this.lastDpadDirection=this.currentDpadDirection,this.currentDpadDirection="up",this.app.fire("movementButtonPress","up"))}else this.app.fire("movementButtonRelease",this.lastDpadDirection),this.clearDpad()},InputManager.prototype.clearDpad=function(){this.lastDpadDirection=void 0,this.currentDpadDirection=void 0,this.app.fire("setDpadSpriteToNeutral")},InputManager.prototype.resetDpadCoords=function(){this.dpadOriginCoords={x:(this.dpad.element.canvasCorners[1].x+this.dpad.element.canvasCorners[0].x)/2,y:(this.dpad.element.canvasCorners[1].y+this.dpad.element.canvasCorners[2].y)/2}},InputManager.prototype.distance2D=function(t,e,i,n){let a=i-t,s=n-e;return Math.sqrt(a*a+s*s)},InputManager.prototype.angleBetweenPts2D=function(t,e,i,n){let a=i-t,s=n-e;return 180*Math.atan2(s,a)/Math.PI+180};var PlayerAnimation=pc.createScript("playerAnimation");PlayerAnimation.prototype.initialize=function(){let i=this;this.isSwinging=!1,this.hasHit=!1,this.currentAnimation=void 0,this.lastDirection="down",this.app.on("player:playAnimation",(function(t,n){i.entity.sprite.frame=0,this.lastDirection=n,"stunned"!=t?(i.entity.sprite.play(t+n),this.currentAnimation=t+n):(i.entity.sprite.play(t),this.currentAnimation=t)}),this)},PlayerAnimation.prototype.update=function(i){this.entity.sprite.clip("swingleft").isPlaying||this.entity.sprite.clip("swingright").isPlaying||this.entity.sprite.clip("swingup").isPlaying||this.entity.sprite.clip("swingdown").isPlaying?(this.isSwinging||(this.isSwinging=!0),4!==this.entity.sprite.frame||this.hasHit||(this.hasHit=!0,this.app.fire("hammerHit",this.lastDirection))):"stunned"===this.currentAnimation?(this.isSwinging&&(this.isSwinging=!1),this.hasHit&&(this.hasHit=!1)):this.isSwinging&&(this.isSwinging=!1,this.app.fire("swingEnd"),this.hasHit=!1)};var AppManager=pc.createScript("appManager");AppManager.attributes.add("scoreTextEntity",{type:"entity"}),AppManager.attributes.add("timerTextEntity",{type:"entity"}),AppManager.attributes.add("endScreenScoreEntity",{type:"entity"}),AppManager.attributes.add("endScreenHiscoreEntity",{type:"entity"}),AppManager.attributes.add("claimCpnGrp",{type:"entity"}),AppManager.attributes.add("noClaimCpnGrp",{type:"entity"}),AppManager.attributes.add("couponURL",{type:"string"}),AppManager.attributes.add("timerLength",{type:"number",description:"time for one round of the game",default:30}),AppManager.attributes.add("couponScoreThreshold",{type:"number",description:"amount for coupon to get displayed at the end of the game",default:100}),AppManager.prototype.initialize=function(){this.score=0,this.hiscore=0,this.gameStarted=!1,this.couponEnabled=!1,this.hasCouponDroppedDownThisGame=!1,this.claimCpnGrp.enabled=!1,this.noClaimCpnGrp.enabled=!0,this.resetTimer(),this.app.on("couponButtonPress",(function(){window.top.location.href=this.couponURL}),this),this.app.on("movementButtonPress",(function(t){this.app.fire("moveStart",t)}),this),this.app.on("movementButtonRelease",(function(t){this.app.fire("moveStop",t)}),this),this.app.on("swingButtonPress",(function(){this.app.fire("swingStart")}),this),this.app.on("startButtonPress",(function(){this.startCountdown()}),this),this.app.on("resetButtonPress",(function(){this.resetGame()}),this),this.app.on("endCountdown",(function(){this.endCountdown()}),this),this.app.on("endTimesUp",(function(){this.endTimesUp()}),this),this.app.on("addPoints",(function(t){this.score+=t;let e=this.score.toString();this.score<10?e="000"+e:this.score<100?e="00"+e:this.score<1e3&&(e="0"+e),this.scoreTextEntity.element.text=e,!1===this.hasCouponDroppedDownThisGame&&this.score>=this.couponScoreThreshold&&(this.app.fire("couponOverlayDropdown"),this.hasCouponDroppedDownThisGame=!0)}),this)},AppManager.prototype.update=function(t){this.gameStarted&&(this.timer-=t,this.timer>0?this.updateTimer():(this.timer=0,this.updateTimer(),this.stopGame()))},AppManager.prototype.startCountdown=function(){this.resetTimer(),this.score=0,this.app.fire("addPoints",0),this.app.fire("resetOverlays"),this.app.fire("startCountdown"),this.app.fire("changeScene","game"),this.hasCouponDroppedDownThisGame=!1},AppManager.prototype.resetTimer=function(){this.timer=this.timerLength,this.updateTimer()},AppManager.prototype.updateEndScreenScores=function(){this.score<10?this.endScreenScoreEntity.element.text="0000"+this.score.toString():this.score<100?this.endScreenScoreEntity.element.text="000"+this.score.toString():this.score<1e3?this.endScreenScoreEntity.element.text="00"+this.score.toString():this.score<1e4?this.endScreenScoreEntity.element.text="0"+this.score.toString():this.endScreenScoreEntity.element.text=this.score.toString(),this.hiscore<10?this.endScreenHiscoreEntity.element.text="0000"+this.hiscore.toString():this.hiscore<100?this.endScreenHiscoreEntity.element.text="000"+this.hiscore.toString():this.hiscore<1e3?this.endScreenHiscoreEntity.element.text="00"+this.hiscore.toString():this.hiscore<1e4?this.endScreenHiscoreEntity.element.text="0"+this.hiscore.toString():this.endScreenHiscoreEntity.element.text=this.hiscore.toString()},AppManager.prototype.updateTimer=function(){let t=(Math.floor(10*this.timer)/10).toFixed(1);this.timer<=0?this.timerTextEntity.element.text="00.0":this.timer<10?this.timerTextEntity.element.text="0"+t.toString():this.timerTextEntity.element.text=t.toString()},AppManager.prototype.endCountdown=function(){this.startGame()},AppManager.prototype.endTimesUp=function(){this.score>this.hiscore&&(this.hiscore=this.score),this.handleCoupon(),this.updateEndScreenScores(),this.app.fire("changeScene","end")},AppManager.prototype.startGame=function(){this.gameStarted=!0,this.app.fire("startGame")},AppManager.prototype.stopGame=function(){this.gameStarted=!1,this.app.fire("stopGame"),this.app.fire("startTimesUp")},AppManager.prototype.resetGame=function(){this.app.fire("resetPlayerController"),this.app.fire("resetMoles"),this.startCountdown()},AppManager.prototype.handleCoupon=function(){this.couponEnabled||this.hiscore>=this.couponScoreThreshold&&(this.claimCpnGrp.enabled=!0,this.noClaimCpnGrp.enabled=!1,this.couponEnabled=!0)};var Collision=pc.createScript("collision");Collision.attributes.add("topLPlayerCol",{type:"entity"}),Collision.attributes.add("topRPlayerCol",{type:"entity"}),Collision.attributes.add("botLPlayerCol",{type:"entity"}),Collision.attributes.add("botRPlayerCol",{type:"entity"}),Collision.prototype.initialize=function(){this.topLPos=this.entity.children[0].getPosition(),this.topRPos=this.entity.children[1].getPosition(),this.botLPos=this.entity.children[2].getPosition(),this.botRPos=this.entity.children[3].getPosition()},Collision.prototype.update=function(t){this.checkCollisionH(this.topLPlayerCol)&&this.checkCollisionV(this.topLPlayerCol)&&this.collisionStart(),this.checkCollisionH(this.topRPlayerCol)&&this.checkCollisionV(this.topRPlayerCol)&&this.collisionStart(),this.checkCollisionH(this.botLPlayerCol)&&this.checkCollisionV(this.botLPlayerCol)&&this.collisionStart(),this.checkCollisionH(this.botRPlayerCol)&&this.checkCollisionV(this.botRPlayerCol)&&this.collisionStart()},Collision.prototype.collisionStart=function(){this.app.fire("collisionStart")},Collision.prototype.checkCollisionH=function(t){return t.getPosition().x>this.topLPos.x&&t.getPosition().x<this.topRPos.x},Collision.prototype.checkCollisionV=function(t){return t.getPosition().y<this.topLPos.y&&t.getPosition().y>this.botLPos.y};var HammerCollisionCheck=pc.createScript("hammerCollisionCheck");HammerCollisionCheck.attributes.add("lHammerCol",{type:"entity"}),HammerCollisionCheck.attributes.add("rHammerCol",{type:"entity"}),HammerCollisionCheck.attributes.add("uHammerCol",{type:"entity"}),HammerCollisionCheck.attributes.add("dHammerCol",{type:"entity"}),HammerCollisionCheck.attributes.add("playerEntity",{type:"entity"}),HammerCollisionCheck.attributes.add("horizontalCollisionPadding",{type:"number",description:"increases width of hitbox",default:.05}),HammerCollisionCheck.attributes.add("topCollisionPadding",{type:"number",description:"increases width of hitbox",default:.35}),HammerCollisionCheck.attributes.add("botCollisionPadding",{type:"number",description:"increases width of hitbox",default:.05}),HammerCollisionCheck.prototype.initialize=function(){let o=this;this.topLPos=this.entity.children[0].getPosition().clone(),this.topRPos=this.entity.children[1].getPosition().clone(),this.botLPos=this.entity.children[2].getPosition().clone(),this.botRPos=this.entity.children[3].getPosition().clone(),this.topLPos.x=this.topLPos.x-this.horizontalCollisionPadding,this.topLPos.y=this.topLPos.y+this.topCollisionPadding,this.topRPos.x=this.topRPos.x+this.horizontalCollisionPadding,this.topRPos.y=this.topRPos.y+this.topCollisionPadding,this.botLPos.x=this.botLPos.x-this.horizontalCollisionPadding,this.botLPos.y=this.botLPos.y-this.botCollisionPadding,this.botRPos.x=this.botRPos.x+this.horizontalCollisionPadding,this.botRPos.y=this.botRPos.y-this.botCollisionPadding,this.currentDirection="down",this.app.on("hammerHit",(function(t){"left"===t&&o.lHammerCol.getPosition().x>o.topLPos.x&&o.lHammerCol.getPosition().x<o.topRPos.x&&o.lHammerCol.getPosition().y<o.topLPos.y&&o.lHammerCol.getPosition().y>o.botLPos.y&&o.app.fire("moleContact",o.entity.parent),"right"===t&&o.rHammerCol.getPosition().x>o.topLPos.x&&o.rHammerCol.getPosition().x<o.topRPos.x&&o.rHammerCol.getPosition().y<o.topLPos.y&&o.rHammerCol.getPosition().y>o.botLPos.y&&o.app.fire("moleContact",o.entity.parent),"up"===t&&o.uHammerCol.getPosition().x>o.topLPos.x&&o.uHammerCol.getPosition().x<o.topRPos.x&&o.uHammerCol.getPosition().y<o.topLPos.y&&o.uHammerCol.getPosition().y>o.botLPos.y&&o.app.fire("moleContact",o.entity.parent),"down"===t&&o.dHammerCol.getPosition().x>o.topLPos.x&&o.dHammerCol.getPosition().x<o.topRPos.x&&o.dHammerCol.getPosition().y<o.topLPos.y&&o.dHammerCol.getPosition().y>o.botLPos.y&&o.app.fire("moleContact",o.entity.parent)}),this)};var PlayerLayerManager=pc.createScript("playerLayerManager");PlayerLayerManager.attributes.add("upperLine",{type:"entity"}),PlayerLayerManager.attributes.add("middleLine",{type:"entity"}),PlayerLayerManager.attributes.add("lowerLine",{type:"entity"}),PlayerLayerManager.prototype.initialize=function(){this.upperPos=this.upperLine.getPosition().y,this.middlePos=this.middleLine.getPosition().y,this.lowerPos=this.lowerLine.getPosition().y,this.changeLayer(4)},PlayerLayerManager.prototype.update=function(t){this.entity.getPosition().y<this.lowerPos&&3!=this.currentLayer?this.changeLayer(3):this.entity.getPosition().y>this.lowerPos&&this.entity.getPosition().y<this.middlePos&&2!=this.currentLayer?this.changeLayer(2):this.entity.getPosition().y>this.middlePos&&this.entity.getPosition().y<this.upperPos&&1!=this.currentLayer?this.changeLayer(1):this.entity.getPosition().y>this.upperPos&&0!=this.currentLayer&&this.changeLayer(0)},PlayerLayerManager.prototype.changeLayer=function(t){this.currentLayer=t,this.entity.setPosition(this.entity.getPosition().x,this.entity.getPosition().y,t)};var MoleManager=pc.createScript("moleManager");MoleManager.attributes.add("timeAboveGround",{type:"number",description:"base time moles should spend above ground",default:4}),MoleManager.attributes.add("groundTimeVariance",{type:"number",description:"variance in time the moles should spend above ground",default:0}),MoleManager.attributes.add("timeInBetweenWaves",{type:"number",description:"time between mole spawn",default:1}),MoleManager.attributes.add("waveTimeVariance",{type:"number",description:"variance in time between spawns",default:.5}),MoleManager.attributes.add("baseMolePointValue",{type:"number",description:"",default:120}),MoleManager.attributes.add("goldMolePointValue",{type:"number",description:"",default:350}),MoleManager.attributes.add("bombMolePointValue",{type:"number",description:"",default:20}),MoleManager.prototype.initialize=function(){this.gameInProgress=!1,this.moles=this.app.root.findByTag("mole"),this.app.on("moleContact",this.hitMole,this),this.app.on("resetMoles",this.resetMoles,this),this.app.on("startGame",(function(){this.gameInProgress=!0}),this),this.app.on("stopGame",(function(){this.gameInProgress=!1}),this),this.entity.on("sucessfulHit",(function(e){"Base"===e?this.app.fire("addPoints",this.baseMolePointValue):"Gold"===e?this.app.fire("addPoints",this.goldMolePointValue):"Bomb"===e&&this.app.fire("addPoints",this.bombMolePointValue)}),this),this.resetTimeToNextWave(),this.moleTypes=["Base","Gold","Bomb"]},MoleManager.prototype.hitMole=function(e){for(let t=0;t<this.moles.length;t++)e===this.moles[t]&&this.moles[t].fire("hit")},MoleManager.prototype.update=function(e){this.timeToNextWave-=e,this.timeToNextWave<=0&&(this.spawnMole(),this.resetTimeToNextWave())},MoleManager.prototype.spawnMole=function(){let e=this.moles[this.getRandomInt(0,this.moles.length)],t=this.timeAboveGround+this.getRandomFloat(-this.groundTimeVariance,this.groundTimeVariance),o=this.moleTypes[this.getRandomInt(0,this.moleTypes.length)];this.gameInProgress||(o=this.moleTypes[0]),e.script.moleController.getIsSpawned()?(e=this.moles[this.getRandomInt(0,this.moles.length)],e.script.moleController.getIsSpawned()||e.fire("spawnMole",t,o)):e.fire("spawnMole",t,o)},MoleManager.prototype.resetMoles=function(){for(let e=0;e<this.moles.length;e++)this.moles[e].fire("despawn")},MoleManager.prototype.resetTimeToNextWave=function(){this.timeToNextWave=this.timeInBetweenWaves+this.getRandomFloat(-this.waveTimeVariance,this.waveTimeVariance)},MoleManager.prototype.getRandomFloat=function(e,t){return Math.random()*(t-e)+e},MoleManager.prototype.getRandomInt=function(e,t){return e=Math.ceil(e),t=Math.floor(t),Math.floor(Math.random()*(t-e)+e)};var MoleController=pc.createScript("moleController");MoleController.attributes.add("explosionSprite",{type:"entity"}),MoleController.prototype.initialize=function(){this.lifeSpan=0,this.type="normal",this.isUp=!1,this.isSpawned=!1,this.isVulnerable=!1,this.hasBeenHit=!1,this.animationState="downIdle",this.isIdleUp=!1,this.isIdleDown=!0,this.entity.on("spawnMole",(function(t,i){Math.random()<.5?this.entity.sprite.flipX=!0:this.entity.sprite.flipX=!1,this.isSpawned=!0,this.lifeSpan=t,this.type=i,this.isUp=!0,this.isIdleDown=!1,this.isVulnerable=!0,this.hasBeenHit=!1,this.playAnimation("goUp")}),this),this.entity.on("hit",(function(){this.isVulnerable&&!this.hasBeenHit&&(this.lifeSpan=0,this.isUp=!1,this.hasBeenHit=!0,this.playAnimation("hit"),this.isIdleUp=!1,this.entity.parent.parent.fire("sucessfulHit",this.type),"Bomb"===this.type&&this.explode())}),this),this.entity.on("despawn",this.despawn,this)},MoleController.prototype.goDown=function(){this.isUp=!1,this.isIdleUp=!1,"Bomb"===this.type?(this.explode(),this.hasBeenHit=!0,this.playAnimation("hit")):this.playAnimation("goDown")},MoleController.prototype.despawn=function(){this.isUp=!1,this.isIdleUp=!1,this.onDown()},MoleController.prototype.onDown=function(){this.isVulnerable=!1,this.hasBeenHit=!1,this.isIdleDown=!0,this.playAnimation("downIdle"),this.isSpawned=!1},MoleController.prototype.goUpIdle=function(){this.isIdleUp=!0,this.playAnimation("upIdle")},MoleController.prototype.explode=function(){this.explosionSprite.sprite.play("explosion"),this.explosionSprite.fire("explosion")},MoleController.prototype.playAnimation=function(t){this.animationState=t,this.entity.sprite.frame=0,"downIdle"===t?this.entity.sprite.play("downIdleBase"):this.entity.sprite.play(t+this.type)},MoleController.prototype.getIsSpawned=function(){return this.isSpawned},MoleController.prototype.update=function(t){this.isUp&&(this.lifeSpan-=t,this.lifeSpan<=0&&this.goDown()),"goUp"===this.animationState&&this.entity.sprite.frame>=9&&!this.isIdleUp&&this.goUpIdle(),"goDown"===this.animationState&&(this.entity.sprite.frame>=9&&!this.isIdleDown||this.entity.sprite.frame>=6&&"Bomb"===this.type&&!this.isIdleDown)&&this.onDown(),"hit"===this.animationState&&this.entity.sprite.frame>=6&&!this.isIdleDown&&this.onDown()};var ExplosionCollision=pc.createScript("explosionCollision");ExplosionCollision.attributes.add("player",{type:"entity"}),ExplosionCollision.attributes.add("radialDistance",{type:"number",description:"increases width of hitbox",default:1.2}),ExplosionCollision.prototype.initialize=function(){this.entity.on("explosion",(function(){this.checkPlayerCollision()}),this)},ExplosionCollision.prototype.checkPlayerCollision=function(){this.getDistanceBetweenTwoEntities(this.player,this.entity)<=1.1&&this.app.fire("playerHitByExplosion")},ExplosionCollision.prototype.getDistanceBetweenTwoEntities=function(i,t){let o=i.getPosition().x-t.getPosition().x,e=i.getPosition().y-t.getPosition().y;return Math.sqrt(o*o+e*e)};// utilFunctions.js


var IOspressFix=pc.createScript("iOspressFix");IOspressFix.prototype.initialize=function(){document.body.style["-webkit-user-select"]="none"};var UiSceneManager=pc.createScript("uiSceneManager");UiSceneManager.attributes.add("startScene",{type:"entity"}),UiSceneManager.attributes.add("inGameScene",{type:"entity"}),UiSceneManager.attributes.add("endScene",{type:"entity"}),UiSceneManager.attributes.add("endSceneBGElement",{type:"entity"}),UiSceneManager.attributes.add("transitionSpeed",{type:"number"}),UiSceneManager.prototype.initialize=function(){let e=this;this.scenes=[this.startScene,this.endScene,this.inGameScene],this.currentScene=this.startScene,this.isEndVisible=!0,this.panRect=new pc.Vec4(0,0,20,29),this.scenes.forEach((function(t){this.currentScene!=t&&e.switchSceneState(t,"off")})),this.tweenOpacity(this.currentScene,"on"),this.opacityTween=void 0,this.app.on("changeScene",(function(t){e.changeScene(t)}),this)},UiSceneManager.prototype.changeScene=function(e){this.tweenOpacity(this.currentScene,"off"),"start"===e?(this.tweenOpacity(this.startScene,"on"),this.currentScene=this.startScene):"game"===e?(this.tweenOpacity(this.inGameScene,"on"),this.currentScene=this.inGameScene):"end"===e&&(this.tweenOpacity(this.endScene,"on"),this.currentScene=this.endScene)},UiSceneManager.prototype.tweenOpacity=function(e,t){let n=e.findComponents("element"),i=this,c={value:n[0].opacity},a=1;"off"===t?(a=0,this.switchButtons(e,"off")):"on"===t&&(n.forEach((function(e){e.opacity=0})),e.setPosition(0,0,0)),this.opacityTween=e.tween(c).to({value:a},this.transitionSpeed,pc.QuadraticInOut).delay(0).on("update",(function(){n.forEach((function(e){e.opacity=c.value}))})).on("complete",(function(){"off"===t?e.setPosition(-1e3,0,0):i.switchButtons(e,"on")})).start()},UiSceneManager.prototype.switchSceneState=function(e,t){this.switchOpacity(e,t),this.switchButtons(e,t)},UiSceneManager.prototype.switchOpacity=function(e,t){let n=1;"off"===t&&(n=0),e.findComponents("button").forEach((function(e){e.opacity=n}))},UiSceneManager.prototype.switchButtons=function(e,t){let n=!0;"off"===t&&(n=!1),e.findComponents("button").forEach((function(e){e.active=n}))},UiSceneManager.prototype.update=function(e){this.isEndVisible&&(this.panRect.x-=.003,this.panRect.y+=.003,this.endSceneBGElement.element.rect=this.panRect)};pc.extend(pc,function(){var TweenManager=function(t){this._app=t,this._tweens=[],this._add=[]};TweenManager.prototype={add:function(t){return this._add.push(t),t},update:function(t){for(var i=0,e=this._tweens.length;i<e;)this._tweens[i].update(t)?i++:(this._tweens.splice(i,1),e--);this._add.length&&(this._tweens=this._tweens.concat(this._add),this._add.length=0)}};var Tween=function(t,i,e){pc.events.attach(this),this.manager=i,e&&(this.entity=null),this.time=0,this.complete=!1,this.playing=!1,this.stopped=!0,this.pending=!1,this.target=t,this.duration=0,this._currentDelay=0,this.timeScale=1,this._reverse=!1,this._delay=0,this._yoyo=!1,this._count=0,this._numRepeats=0,this._repeatDelay=0,this._from=!1,this._slerp=!1,this._fromQuat=new pc.Quat,this._toQuat=new pc.Quat,this._quat=new pc.Quat,this.easing=pc.Linear,this._sv={},this._ev={}},_parseProperties=function(t){var i;return t instanceof pc.Vec2?i={x:t.x,y:t.y}:t instanceof pc.Vec3?i={x:t.x,y:t.y,z:t.z}:t instanceof pc.Vec4||t instanceof pc.Quat?i={x:t.x,y:t.y,z:t.z,w:t.w}:t instanceof pc.Color?(i={r:t.r,g:t.g,b:t.b},void 0!==t.a&&(i.a=t.a)):i=t,i};Tween.prototype={to:function(t,i,e,s,n,r){return this._properties=_parseProperties(t),this.duration=i,e&&(this.easing=e),s&&this.delay(s),n&&this.repeat(n),r&&this.yoyo(r),this},from:function(t,i,e,s,n,r){return this._properties=_parseProperties(t),this.duration=i,e&&(this.easing=e),s&&this.delay(s),n&&this.repeat(n),r&&this.yoyo(r),this._from=!0,this},rotate:function(t,i,e,s,n,r){return this._properties=_parseProperties(t),this.duration=i,e&&(this.easing=e),s&&this.delay(s),n&&this.repeat(n),r&&this.yoyo(r),this._slerp=!0,this},start:function(){var t,i,e,s;if(this.playing=!0,this.complete=!1,this.stopped=!1,this._count=0,this.pending=this._delay>0,this._reverse&&!this.pending?this.time=this.duration:this.time=0,this._from){for(t in this._properties)this._properties.hasOwnProperty(t)&&(this._sv[t]=this._properties[t],this._ev[t]=this.target[t]);this._slerp&&(this._toQuat.setFromEulerAngles(this.target.x,this.target.y,this.target.z),i=void 0!==this._properties.x?this._properties.x:this.target.x,e=void 0!==this._properties.y?this._properties.y:this.target.y,s=void 0!==this._properties.z?this._properties.z:this.target.z,this._fromQuat.setFromEulerAngles(i,e,s))}else{for(t in this._properties)this._properties.hasOwnProperty(t)&&(this._sv[t]=this.target[t],this._ev[t]=this._properties[t]);this._slerp&&(i=void 0!==this._properties.x?this._properties.x:this.target.x,e=void 0!==this._properties.y?this._properties.y:this.target.y,s=void 0!==this._properties.z?this._properties.z:this.target.z,void 0!==this._properties.w?(this._fromQuat.copy(this.target),this._toQuat.set(i,e,s,this._properties.w)):(this._fromQuat.setFromEulerAngles(this.target.x,this.target.y,this.target.z),this._toQuat.setFromEulerAngles(i,e,s)))}return this._currentDelay=this._delay,this.manager.add(this),this},pause:function(){this.playing=!1},resume:function(){this.playing=!0},stop:function(){this.playing=!1,this.stopped=!0},delay:function(t){return this._delay=t,this.pending=!0,this},repeat:function(t,i){return this._count=0,this._numRepeats=t,this._repeatDelay=i||0,this},loop:function(t){return t?(this._count=0,this._numRepeats=1/0):this._numRepeats=0,this},yoyo:function(t){return this._yoyo=t,this},reverse:function(){return this._reverse=!this._reverse,this},chain:function(){for(var t=arguments.length;t--;)t>0?arguments[t-1]._chained=arguments[t]:this._chained=arguments[t];return this},update:function(t){if(this.stopped)return!1;if(!this.playing)return!0;if(!this._reverse||this.pending?this.time+=t*this.timeScale:this.time-=t*this.timeScale,this.pending){if(!(this.time>this._currentDelay))return!0;this._reverse?this.time=this.duration-(this.time-this._currentDelay):this.time-=this._currentDelay,this.pending=!1}var i=0;(!this._reverse&&this.time>this.duration||this._reverse&&this.time<0)&&(this._count++,this.complete=!0,this.playing=!1,this._reverse?(i=this.duration-this.time,this.time=0):(i=this.time-this.duration,this.time=this.duration));var e,s,n=0===this.duration?1:this.time/this.duration,r=this.easing(n);for(var h in this._properties)this._properties.hasOwnProperty(h)&&(e=this._sv[h],s=this._ev[h],this.target[h]=e+(s-e)*r);if(this._slerp&&this._quat.slerp(this._fromQuat,this._toQuat,r),this.entity&&(this.entity._dirtifyLocal(),this.element&&this.entity.element&&(this.entity.element[this.element]=this.target),this._slerp&&this.entity.setLocalRotation(this._quat)),this.fire("update",t),this.complete){var a=this._repeat(i);return a?this.fire("loop"):(this.fire("complete",i),this.entity&&this.entity.off("destroy",this.stop,this),this._chained&&this._chained.start()),a}return!0},_repeat:function(t){if(this._count<this._numRepeats){if(this._reverse?this.time=this.duration-t:this.time=t,this.complete=!1,this.playing=!0,this._currentDelay=this._repeatDelay,this.pending=!0,this._yoyo){for(var i in this._properties){var e=this._sv[i];this._sv[i]=this._ev[i],this._ev[i]=e}this._slerp&&(this._quat.copy(this._fromQuat),this._fromQuat.copy(this._toQuat),this._toQuat.copy(this._quat))}return!0}return!1}};var BounceOut=function(t){return t<1/2.75?7.5625*t*t:t<2/2.75?7.5625*(t-=1.5/2.75)*t+.75:t<2.5/2.75?7.5625*(t-=2.25/2.75)*t+.9375:7.5625*(t-=2.625/2.75)*t+.984375},BounceIn=function(t){return 1-BounceOut(1-t)};return{TweenManager:TweenManager,Tween:Tween,Linear:function(t){return t},QuadraticIn:function(t){return t*t},QuadraticOut:function(t){return t*(2-t)},QuadraticInOut:function(t){return(t*=2)<1?.5*t*t:-.5*(--t*(t-2)-1)},CubicIn:function(t){return t*t*t},CubicOut:function(t){return--t*t*t+1},CubicInOut:function(t){return(t*=2)<1?.5*t*t*t:.5*((t-=2)*t*t+2)},QuarticIn:function(t){return t*t*t*t},QuarticOut:function(t){return 1- --t*t*t*t},QuarticInOut:function(t){return(t*=2)<1?.5*t*t*t*t:-.5*((t-=2)*t*t*t-2)},QuinticIn:function(t){return t*t*t*t*t},QuinticOut:function(t){return--t*t*t*t*t+1},QuinticInOut:function(t){return(t*=2)<1?.5*t*t*t*t*t:.5*((t-=2)*t*t*t*t+2)},SineIn:function(t){return 0===t?0:1===t?1:1-Math.cos(t*Math.PI/2)},SineOut:function(t){return 0===t?0:1===t?1:Math.sin(t*Math.PI/2)},SineInOut:function(t){return 0===t?0:1===t?1:.5*(1-Math.cos(Math.PI*t))},ExponentialIn:function(t){return 0===t?0:Math.pow(1024,t-1)},ExponentialOut:function(t){return 1===t?1:1-Math.pow(2,-10*t)},ExponentialInOut:function(t){return 0===t?0:1===t?1:(t*=2)<1?.5*Math.pow(1024,t-1):.5*(2-Math.pow(2,-10*(t-1)))},CircularIn:function(t){return 1-Math.sqrt(1-t*t)},CircularOut:function(t){return Math.sqrt(1- --t*t)},CircularInOut:function(t){return(t*=2)<1?-.5*(Math.sqrt(1-t*t)-1):.5*(Math.sqrt(1-(t-=2)*t)+1)},BackIn:function(t){var i=1.70158;return t*t*((i+1)*t-i)},BackOut:function(t){var i=1.70158;return--t*t*((i+1)*t+i)+1},BackInOut:function(t){var i=2.5949095;return(t*=2)<1?t*t*((i+1)*t-i)*.5:.5*((t-=2)*t*((i+1)*t+i)+2)},BounceIn:BounceIn,BounceOut:BounceOut,BounceInOut:function(t){return t<.5?.5*BounceIn(2*t):.5*BounceOut(2*t-1)+.5},ElasticIn:function(t){var i,e=.1;return 0===t?0:1===t?1:(!e||e<1?(e=1,i=.1):i=.4*Math.asin(1/e)/(2*Math.PI),-e*Math.pow(2,10*(t-=1))*Math.sin((t-i)*(2*Math.PI)/.4))},ElasticOut:function(t){var i,e=.1;return 0===t?0:1===t?1:(!e||e<1?(e=1,i=.1):i=.4*Math.asin(1/e)/(2*Math.PI),e*Math.pow(2,-10*t)*Math.sin((t-i)*(2*Math.PI)/.4)+1)},ElasticInOut:function(t){var i,e=.1,s=.4;return 0===t?0:1===t?1:(!e||e<1?(e=1,i=.1):i=s*Math.asin(1/e)/(2*Math.PI),(t*=2)<1?e*Math.pow(2,10*(t-=1))*Math.sin((t-i)*(2*Math.PI)/s)*-.5:e*Math.pow(2,-10*(t-=1))*Math.sin((t-i)*(2*Math.PI)/s)*.5+1)}}}()),function(){pc.Application.prototype.addTweenManager=function(){this._tweenManager=new pc.TweenManager(this),this.on("update",(function(t){this._tweenManager.update(t)}))},pc.Application.prototype.tween=function(t){return new pc.Tween(t,this._tweenManager)},pc.Entity.prototype.tween=function(t,i){var e=this._app.tween(t);return e.entity=this,this.once("destroy",e.stop,e),i&&i.element&&(e.element=i.element),e};var t=pc.Application.getApplication();t&&t.addTweenManager()}();var CountdownManager=pc.createScript("countdownManager");CountdownManager.attributes.add("one",{type:"entity"}),CountdownManager.attributes.add("two",{type:"entity"}),CountdownManager.attributes.add("three",{type:"entity"}),CountdownManager.attributes.add("go",{type:"entity"}),CountdownManager.prototype.initialize=function(){let t=this;this.opacityObject={value:0},this.opacityTween=void 0,this.app.on("startCountdown",(function(){for(let e=0;e<t.entity.children.length;e++)t.entity.children[e].element.opacity=1,t.entity.children[e].enabled=!1;this.three.enabled=!0,this.three.element.opacity=0,this.opacityTween=this.entity.tween(this.opacityObject).to({value:1},.3,pc.QuadraticInOut).on("update",(function(){t.three.element.opacity=t.opacityObject.value})).on("complete",(function(){this.app.tween({}).to({},.9,pc.Linear).on("complete",(function(){this.three.enabled=!1,this.two.enabled=!0,this.app.tween({}).to({},1.2,pc.Linear).on("complete",(function(){this.two.enabled=!1,this.one.enabled=!0,this.app.tween({}).to({},1.2,pc.Linear).on("complete",(function(){this.one.enabled=!1,this.app.fire("endCountdown"),this.go.enabled=!0,this.opacityTween=this.entity.tween(this.opacityObject).to({value:0},.3,pc.QuadraticInOut).delay(.5).on("update",(function(){t.go.element.opacity=t.opacityObject.value})).start()}),this).start()}),this).start()}),this).start()}),this).start()}),this),this.app.on("resetOverlays",(function(){for(let e=0;e<t.entity.children.length;e++)t.entity.children[e].element.opacity=1,t.entity.children[e].enabled=!1}))};var TimesUpmanager=pc.createScript("timesUpmanager");TimesUpmanager.attributes.add("timesUp",{type:"entity"}),TimesUpmanager.prototype.initialize=function(){let t=this;this.opacityObject={value:0},this.opacityTween=void 0,this.app.on("resetOverlays",(function(){for(let e=0;e<t.entity.children.length;e++)t.entity.children[e].element.opacity=0,t.entity.children[e].enabled=!0;this.opacityObject={value:0}}),this),this.app.on("startTimesUp",(function(){for(let e=0;e<t.entity.children.length;e++)t.entity.children[e].element.opacity=0,t.entity.children[e].enabled=!0;this.opacityTween=this.entity.tween(this.opacityObject).to({value:1},.15,pc.QuadraticInOut).delay(0).on("update",(function(){for(let e=0;e<t.entity.children.length;e++)t.entity.children[e].element.opacity=t.opacityObject.value})).on("complete",(function(){this.app.tween({}).to({},1.5,pc.Linear).delay(0).on("complete",(function(){this.app.fire("endTimesUp")}),this).start()}),this).start()}),this)};var DpadAnimationManager=pc.createScript("dpadAnimationManager");DpadAnimationManager.attributes.add("dpadNeutral",{type:"asset",assetType:"sprite"}),DpadAnimationManager.attributes.add("dpadLeft",{type:"asset",assetType:"sprite"}),DpadAnimationManager.attributes.add("dpadRight",{type:"asset",assetType:"sprite"}),DpadAnimationManager.attributes.add("dpadUp",{type:"asset",assetType:"sprite"}),DpadAnimationManager.attributes.add("dpadDown",{type:"asset",assetType:"sprite"}),DpadAnimationManager.prototype.initialize=function(){this.entity.element.sprite=this.dpadNeutral.resource,this.app.on("movementButtonPress",(function(t){"left"===t?this.entity.element.sprite=this.dpadLeft.resource:"right"===t?this.entity.element.sprite=this.dpadRight.resource:"up"===t?this.entity.element.sprite=this.dpadUp.resource:"down"===t&&(this.entity.element.sprite=this.dpadDown.resource)}),this),this.app.on("setDpadSpriteToNeutral",(function(){this.entity.element.sprite=this.dpadNeutral.resource}),this)};var CouponOverlay=pc.createScript("couponOverlay");CouponOverlay.prototype.initialize=function(){var t=this;this.entity.enabled=!0,this.onScreenPos=this.entity.getLocalPosition().clone(),this.offScreenPos=new pc.Vec3(0,this.onScreenPos.y+100,0),this.entity.setLocalPosition(this.offScreenPos),this.app.on("couponOverlayDropdown",(function(){t.couponNotifAnimation()}),this)},CouponOverlay.prototype.couponNotifAnimation=function(){var t=this;this.tween=this.entity.tween(this.entity.getLocalPosition()).to(this.onScreenPos,.3,pc.QuadraticOut).delay(.5).loop(!1).yoyo(!1).on("complete",(function(){t.tween=t.entity.tween(this.entity.getLocalPosition()).to(t.offScreenPos,.3,pc.QuadraticIn).delay(6).loop(!1).yoyo(!1).start()}),this).start()};